2025-04-04 21:21:18 [INFO] - === 微信AI助手启动 ===
2025-04-04 21:21:18 [INFO] - 初始化主应用程序
2025-04-04 21:21:18 [INFO] - 设置UI事件处理器完成
2025-04-04 21:21:18 [INFO] - 显示主窗口
2025-04-04 21:21:19 [INFO] - 进入应用程序主循环
2025-04-04 21:21:22 [INFO] - 开始启动监控
2025-04-04 21:21:22 [INFO] - 初始化微信处理器
2025-04-04 21:21:24 [INFO] - 微信处理器初始化完成
2025-04-04 21:21:24 [INFO] - 初始化AI处理器
2025-04-04 21:21:24 [INFO] - 开始配置AI服务...
2025-04-04 21:21:24 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-04 21:21:24 [INFO] - AI服务配置完成
2025-04-04 21:21:24 [INFO] - 连接微信客户端
2025-04-04 21:21:24 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-04 21:21:24 [INFO] - 已连接微信账号: 上下左右
2025-04-04 21:21:24 [INFO] - 创建消息监控器
2025-04-04 21:21:24 [INFO] - 消息监控器初始化完成
2025-04-04 21:21:24 [INFO] - 设置微信监听
2025-04-04 21:21:24 [INFO] - 开始设置 1 个监听目标
2025-04-04 21:21:24 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-04 21:21:29 [INFO] - 监听设置完成，成功添加 0 个目标
2025-04-04 21:21:29 [INFO] - 未设置特定监听目标，监听所有聊天
2025-04-04 21:21:29 [INFO] - 启动消息监控线程
2025-04-04 21:21:29 [INFO] - 监控已成功启动
2025-04-04 21:21:29 [INFO] - 消息监控线程启动
2025-04-04 21:21:37.037 wxauto.py[574] AddListenChat -> Can not move cursor. ListItemControl's BoundingRectangle is (0,0,0,0)[0x0]. SearchProperties: {RegexName: '文件传输助手', ControlType: ListItemControl}
2025-04-04 21:21:37 [ERROR] - 添加监听目标 文件传输助手 失败: cannot unpack non-iterable NoneType object
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\src\wechat_handler.py", line 114, in _setup_listener
    self.wx.AddListenChat(target, savepic=True, savefile=True, savevoice=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\wxauto.py", line 574, in AddListenChat
    self.SessionBox.ListItemControl(RegexName=who).DoubleClick(simulateMove=False)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\uiautomation.py", line 6193, in DoubleClick
    x, y = self.MoveCursorToInnerPos(x, y, ratioX, ratioY, simulateMove)
    ^^^^
TypeError: cannot unpack non-iterable NoneType object
2025-04-04 21:21:42 [INFO] - 停止监控
2025-04-04 21:21:42 [INFO] - 停止消息监控线程
2025-04-04 21:21:42 [INFO] - 消息监控线程已停止
2025-04-04 21:21:42 [INFO] - 开始清理所有监听目标
2025-04-04 21:21:42 [INFO] - 尝试移除监听目标: 文件传输助手
2025-04-04 21:21:49 [INFO] - 成功移除监听目标: 文件传输助手
2025-04-04 21:21:49 [INFO] - 所有监听目标已清理完成
2025-04-04 21:21:49 [INFO] - 微信监听已清理
2025-04-04 21:21:49 [INFO] - 监控已完全停止
2025-04-04 21:21:53 [INFO] - 开始启动监控
2025-04-04 21:21:53 [INFO] - 初始化微信处理器
2025-04-04 21:21:55 [INFO] - 微信处理器初始化完成
2025-04-04 21:21:55 [INFO] - 初始化AI处理器
2025-04-04 21:21:55 [INFO] - 开始配置AI服务...
2025-04-04 21:21:55 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-04 21:21:55 [INFO] - AI服务配置完成
2025-04-04 21:21:55 [INFO] - 连接微信客户端
2025-04-04 21:21:55 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-04 21:21:55 [INFO] - 已连接微信账号: 上下左右
2025-04-04 21:21:55 [INFO] - 创建消息监控器
2025-04-04 21:21:55 [INFO] - 消息监控器初始化完成
2025-04-04 21:21:55 [INFO] - 设置微信监听
2025-04-04 21:21:55 [INFO] - 开始设置 1 个监听目标
2025-04-04 21:21:55 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-04 21:22:00 [INFO] - 监听设置完成，成功添加 0 个目标
2025-04-04 21:22:00 [INFO] - 未设置特定监听目标，监听所有聊天
2025-04-04 21:22:00 [INFO] - 启动消息监控线程
2025-04-04 21:22:00 [INFO] - 监控已成功启动
2025-04-04 21:22:00 [INFO] - 消息监控线程启动
2025-04-04 21:22:00 [INFO] - 成功添加监听目标: 文件传输助手
2025-04-04 21:22:16 [INFO] - 从 文件传输助手 获取到 2 条新消息
2025-04-04 21:22:16 [INFO] - 收到来自 文件传输助手 的消息: 21:22
2025-04-04 21:22:16 [INFO] - 收到来自 文件传输助手 的消息: 你好你好你好
2025-04-04 21:22:16 [INFO] - 已缓存来自 文件传输助手 的消息: 你好你好你好
2025-04-04 21:22:18 [INFO] - 从 文件传输助手 获取到 1 条新消息
2025-04-04 21:22:18 [INFO] - 收到来自 文件传输助手 的消息: 123
2025-04-04 21:22:18 [INFO] - 已缓存来自 文件传输助手 的消息: 123
2025-04-04 21:22:20 [INFO] - 从 文件传输助手 获取到 1 条新消息
2025-04-04 21:22:20 [INFO] - 收到来自 文件传输助手 的消息: 456
2025-04-04 21:22:20 [INFO] - 已缓存来自 文件传输助手 的消息: 456
2025-04-04 21:22:23 [INFO] - 开始处理来自 文件传输助手 的消息组合
2025-04-04 21:22:23 [INFO] - 开始处理消息: 用户发送了以下多条消息：
用户: 你好你好你好
用户: 123
用户: 456
请统一回复这些消息。
2025-04-04 21:22:23 [INFO] - 使用模型 deepseek-ai/DeepSeek-R1-Distill-Qwen-7B 发送请求
2025-04-04 21:22:25 [INFO] - 收到AI响应: 你好！很高兴为你服务。请问有什么可以帮您的吗？
2025-04-04 21:22:25 [INFO] - 收到AI回复: 你好！很高兴为你服务。请问有什么可以帮您的吗？
2025-04-04 21:22:25 [INFO] - 尝试发送消息到 文件传输助手: 你好！很高兴为你服务。请问有什么可以帮您的吗？
2025-04-04 21:22:27 [INFO] - 成功发送消息到 文件传输助手
2025-04-04 21:22:27 [INFO] - 已成功发送回复到 文件传输助手
2025-04-04 21:22:28 [INFO] - 从 文件传输助手 获取到 1 条新消息
2025-04-04 21:22:28 [INFO] - 收到来自 文件传输助手 的消息: 你好！很高兴为你服务。请问有什么可以帮您的吗？
2025-04-04 21:22:28 [INFO] - 跳过缓存AI回复内容: 你好！很高兴为你服务。请问有什么可以帮您的吗？
2025-04-04 21:24:19 [INFO] - === 微信AI助手退出，退出码: 0 ===
2025-04-04 21:35:27 [INFO] - 全局异常处理器已安装
2025-04-04 21:35:27 [INFO] - === 微信AI助手启动 ===
2025-04-04 21:35:27 [INFO] - 初始化主应用程序
2025-04-04 21:35:27 [CRITICAL] - 程序崩溃: name 'QtCore' is not defined
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\main.py", line 270, in <module>
    app = MainApp()
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\main.py", line 161, in __init__
    QtCore.qInstallMessageHandler(qt_message_handler)
    ^^^^^^
NameError: name 'QtCore' is not defined
2025-04-04 21:41:46 [INFO] - 全局异常处理器已安装
2025-04-04 21:41:46 [INFO] - === 微信AI助手启动 ===
2025-04-04 21:41:46 [INFO] - 初始化主应用程序
2025-04-04 21:41:46 [CRITICAL] - 程序崩溃: name 'QtCore' is not defined
Traceback (most recent call last):
  File "C:\Users\32294\Desktop\微信机器人相关代码\源码\wx\main.py", line 270, in <module>
    app = MainApp()
  File "C:\Users\32294\Desktop\微信机器人相关代码\源码\wx\main.py", line 161, in __init__
    QtCore.qInstallMessageHandler(qt_message_handler)
    ^^^^^^
NameError: name 'QtCore' is not defined
2025-04-04 21:41:51 [INFO] - 全局异常处理器已安装
2025-04-04 21:41:51 [INFO] - === 微信AI助手启动 ===
2025-04-04 21:41:51 [INFO] - 初始化主应用程序
2025-04-04 21:41:51 [CRITICAL] - 程序崩溃: name 'QtCore' is not defined
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\main.py", line 270, in <module>
    app = MainApp()
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\main.py", line 161, in __init__
    QtCore.qInstallMessageHandler(qt_message_handler)
    ^^^^^^
NameError: name 'QtCore' is not defined
2025-04-04 21:42:46 [INFO] - 全局异常处理器已安装
2025-04-04 21:42:46 [INFO] - === 微信AI助手启动 ===
2025-04-04 21:42:46 [INFO] - 初始化主应用程序
2025-04-04 21:42:46 [INFO] - 设置UI事件处理器完成
2025-04-04 21:42:46 [INFO] - 显示主窗口
2025-04-04 21:42:47 [INFO] - 进入应用程序主循环
2025-04-04 21:43:06 [INFO] - 开始启动监控
2025-04-04 21:43:06 [INFO] - 初始化微信处理器
2025-04-04 21:43:08 [INFO] - 微信处理器初始化完成
2025-04-04 21:43:08 [INFO] - 初始化AI处理器
2025-04-04 21:43:08 [INFO] - 开始配置AI服务...
2025-04-04 21:43:08 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-04 21:43:08 [INFO] - AI服务配置完成
2025-04-04 21:43:08 [INFO] - 连接微信客户端
2025-04-04 21:43:08 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-04 21:43:08 [INFO] - 已连接微信账号: 上下左右
2025-04-04 21:43:08 [INFO] - 创建消息监控器
2025-04-04 21:43:08 [INFO] - 消息监控器初始化完成
2025-04-04 21:43:08 [INFO] - 设置微信监听
2025-04-04 21:43:08 [INFO] - 开始设置 1 个监听目标
2025-04-04 21:43:08 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-04 21:43:13 [INFO] - 监听设置完成，成功添加 0 个目标
2025-04-04 21:43:13 [INFO] - 未设置特定监听目标，监听所有聊天
2025-04-04 21:43:13 [INFO] - 启动消息监控线程
2025-04-04 21:43:13 [INFO] - 监控已成功启动
2025-04-04 21:43:13 [INFO] - 消息监控线程启动
2025-04-04 21:43:18 [ERROR] - 添加监听目标 文件传输助手 失败: list index out of range
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\src\wechat_handler.py", line 114, in _setup_listener
    self.wx.AddListenChat(target, savepic=True, savefile=True, savevoice=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\wxauto.py", line 573, in AddListenChat
    self.ChatWith(who)
    ~~~~~~~~~~~~~^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\wxauto.py", line 327, in ChatWith
    search_result_control = self.SessionBox.GetChildren()[1].GetChildren()[1].GetFirstChildControl()
                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
IndexError: list index out of range
2025-04-04 21:43:18 [WARNING] - Qt警告: QObject::connect: Cannot queue arguments of type 'QTextCursor'
(Make sure 'QTextCursor' is registered using qRegisterMetaType().)
2025-04-04 21:43:21 [INFO] - 停止监控
2025-04-04 21:43:21 [INFO] - 停止消息监控线程
2025-04-04 21:43:21 [INFO] - 消息监控线程已停止
2025-04-04 21:43:21 [INFO] - 开始清理所有监听目标
2025-04-04 21:43:21 [INFO] - 尝试移除监听目标: 文件传输助手
2025-04-04 21:43:28 [INFO] - 成功移除监听目标: 文件传输助手
2025-04-04 21:43:28 [INFO] - 所有监听目标已清理完成
2025-04-04 21:43:28 [INFO] - 微信监听已清理
2025-04-04 21:43:28 [INFO] - 监控已完全停止
2025-04-04 21:43:36 [INFO] - 开始启动监控
2025-04-04 21:43:36 [INFO] - 初始化微信处理器
2025-04-04 21:43:38 [INFO] - 微信处理器初始化完成
2025-04-04 21:43:38 [INFO] - 初始化AI处理器
2025-04-04 21:43:38 [INFO] - 开始配置AI服务...
2025-04-04 21:43:38 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-04 21:43:38 [INFO] - AI服务配置完成
2025-04-04 21:43:38 [INFO] - 连接微信客户端
2025-04-04 21:43:38 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-04 21:43:38 [INFO] - 已连接微信账号: 上下左右
2025-04-04 21:43:38 [INFO] - 创建消息监控器
2025-04-04 21:43:38 [INFO] - 消息监控器初始化完成
2025-04-04 21:43:38 [INFO] - 设置微信监听
2025-04-04 21:43:38 [INFO] - 开始设置 1 个监听目标
2025-04-04 21:43:38 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-04 21:43:43 [INFO] - 监听设置完成，成功添加 0 个目标
2025-04-04 21:43:43 [INFO] - 未设置特定监听目标，监听所有聊天
2025-04-04 21:43:43 [INFO] - 启动消息监控线程
2025-04-04 21:43:43 [INFO] - 监控已成功启动
2025-04-04 21:43:43 [INFO] - 消息监控线程启动
2025-04-04 21:43:43 [INFO] - 成功添加监听目标: 文件传输助手
2025-04-04 21:43:51 [INFO] - 从 文件传输助手 获取到 2 条新消息
2025-04-04 21:43:51 [INFO] - 收到来自 文件传输助手 的消息: 21:43
2025-04-04 21:43:51 [INFO] - 收到来自 文件传输助手 的消息: 123456
2025-04-04 21:43:51 [INFO] - 已缓存来自 文件传输助手 的消息: 123456
2025-04-04 21:43:54 [INFO] - 从 文件传输助手 获取到 1 条新消息
2025-04-04 21:43:54 [INFO] - 收到来自 文件传输助手 的消息: +123456
2025-04-04 21:43:54 [INFO] - 已缓存来自 文件传输助手 的消息: +123456
2025-04-04 21:43:58 [INFO] - 开始处理来自 文件传输助手 的消息组合
2025-04-04 21:43:58 [INFO] - 开始处理消息: 用户发送了以下多条消息：
用户: 123456
用户: +123456
请统一回复这些消息。
2025-04-04 21:43:58 [INFO] - 使用模型 deepseek-ai/DeepSeek-R1-Distill-Qwen-7B 发送请求
2025-04-04 21:44:00 [INFO] - 收到AI响应: 收到123456和+123456。
2025-04-04 21:44:00 [INFO] - 收到AI回复: 收到123456和+123456。
2025-04-04 21:44:00 [INFO] - 尝试发送消息到 文件传输助手: 收到123456和+123456。
2025-04-04 21:44:03 [INFO] - 成功发送消息到 文件传输助手
2025-04-04 21:44:03 [INFO] - 已成功发送回复到 文件传输助手
2025-04-04 21:44:04 [INFO] - 从 文件传输助手 获取到 1 条新消息
2025-04-04 21:44:04 [INFO] - 收到来自 文件传输助手 的消息: 收到123456和+123456。
2025-04-04 21:44:04 [INFO] - 跳过缓存AI回复内容: 收到123456和+123456。
2025-04-04 21:44:35 [INFO] - 停止监控
2025-04-04 21:44:35 [INFO] - 停止消息监控线程
2025-04-04 21:44:35 [INFO] - 消息监控线程已停止
2025-04-04 21:44:35 [INFO] - 开始清理所有监听目标
2025-04-04 21:44:35 [INFO] - 尝试移除监听目标: 文件传输助手
2025-04-04 21:44:43 [INFO] - 成功移除监听目标: 文件传输助手
2025-04-04 21:44:43 [INFO] - 所有监听目标已清理完成
2025-04-04 21:44:43 [INFO] - 微信监听已清理
2025-04-04 21:44:43 [INFO] - 监控已完全停止
2025-04-04 21:44:45 [INFO] - === 微信AI助手退出，退出码: 0 ===
2025-04-04 22:06:05 [INFO] - 全局异常处理器已安装
2025-04-04 22:06:05 [INFO] - === 微信AI助手启动 ===
2025-04-04 22:06:05 [INFO] - 初始化主应用程序
2025-04-04 22:06:05 [INFO] - 设置UI事件处理器完成
2025-04-04 22:06:05 [INFO] - 显示主窗口
2025-04-04 22:06:05 [INFO] - 进入应用程序主循环
2025-04-04 22:06:23 [INFO] - 开始启动监控
2025-04-04 22:06:23 [INFO] - 初始化微信处理器
2025-04-04 22:06:24 [INFO] - 微信处理器初始化完成
2025-04-04 22:06:24 [INFO] - 初始化AI处理器
2025-04-04 22:06:24 [INFO] - 开始配置AI服务...
2025-04-04 22:06:24 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-04 22:06:24 [INFO] - AI服务配置完成
2025-04-04 22:06:24 [INFO] - 连接微信客户端
2025-04-04 22:06:24 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-04 22:06:24 [INFO] - 已连接微信账号: 上下左右
2025-04-04 22:06:24 [INFO] - 创建消息监控器
2025-04-04 22:06:24 [INFO] - 消息监控器初始化完成
2025-04-04 22:06:24 [INFO] - 设置微信监听
2025-04-04 22:06:24 [INFO] - 开始设置 1 个监听目标
2025-04-04 22:06:24 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-04 22:06:29 [INFO] - 监听设置完成，成功添加 0 个目标
2025-04-04 22:06:29 [INFO] - 未设置特定监听目标，监听所有聊天
2025-04-04 22:06:29 [INFO] - 启动消息监控线程
2025-04-04 22:06:29 [INFO] - 监控已成功启动
2025-04-04 22:06:29 [INFO] - 消息监控线程启动
2025-04-04 22:06:30 [INFO] - 成功添加监听目标: 文件传输助手
2025-04-04 22:06:30 [WARNING] - Qt警告: QObject::connect: Cannot queue arguments of type 'QTextCursor'
(Make sure 'QTextCursor' is registered using qRegisterMetaType().)
2025-04-04 22:06:35 [INFO] - 停止监控
2025-04-04 22:06:35 [INFO] - 停止消息监控线程
2025-04-04 22:06:35 [INFO] - 消息监控线程已停止
2025-04-04 22:06:35 [INFO] - 开始清理所有监听目标
2025-04-04 22:06:35 [INFO] - 尝试移除监听目标: 文件传输助手
2025-04-04 22:06:52 [INFO] - 成功移除监听目标: 文件传输助手
2025-04-04 22:06:52 [INFO] - 所有监听目标已清理完成
2025-04-04 22:06:52 [INFO] - 微信监听已清理
2025-04-04 22:06:52 [INFO] - 监控已完全停止
2025-04-04 22:07:10 [INFO] - 停止监控
2025-04-04 22:07:10 [INFO] - 停止消息监控线程
2025-04-04 22:07:10 [INFO] - 消息监控线程已停止
2025-04-04 22:07:10 [INFO] - 开始清理所有监听目标
2025-04-04 22:07:10 [INFO] - 所有监听目标已清理完成
2025-04-04 22:07:10 [INFO] - 微信监听已清理
2025-04-04 22:07:10 [INFO] - 监控已完全停止
2025-04-04 22:07:11 [INFO] - 开始启动监控
2025-04-04 22:07:11 [INFO] - 初始化微信处理器
2025-04-04 22:07:12 [INFO] - 微信处理器初始化完成
2025-04-04 22:07:12 [INFO] - 初始化AI处理器
2025-04-04 22:07:12 [INFO] - 开始配置AI服务...
2025-04-04 22:07:12 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-04 22:07:12 [INFO] - AI服务配置完成
2025-04-04 22:07:12 [INFO] - 连接微信客户端
2025-04-04 22:07:12 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-04 22:07:12 [INFO] - 已连接微信账号: 上下左右
2025-04-04 22:07:12 [INFO] - 创建消息监控器
2025-04-04 22:07:12 [INFO] - 消息监控器初始化完成
2025-04-04 22:07:12 [INFO] - 设置微信监听
2025-04-04 22:07:12 [INFO] - 开始设置 1 个监听目标
2025-04-04 22:07:12 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-04 22:07:17 [INFO] - 监听设置完成，成功添加 0 个目标
2025-04-04 22:07:17 [INFO] - 未设置特定监听目标，监听所有聊天
2025-04-04 22:07:17 [INFO] - 启动消息监控线程
2025-04-04 22:07:17 [INFO] - 监控已成功启动
2025-04-04 22:07:17 [INFO] - 消息监控线程启动
2025-04-04 22:07:34.359 wxauto.py[574] AddListenChat -> Can not move cursor. ListItemControl's BoundingRectangle is (0,0,0,0)[0x0]. SearchProperties: {RegexName: '文件传输助手', ControlType: ListItemControl}
2025-04-04 22:07:34 [ERROR] - 添加监听目标 文件传输助手 失败: cannot unpack non-iterable NoneType object
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\src\wechat_handler.py", line 114, in _setup_listener
    self.wx.AddListenChat(target, savepic=True, savefile=True, savevoice=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\wxauto.py", line 574, in AddListenChat
    self.SessionBox.ListItemControl(RegexName=who).DoubleClick(simulateMove=False)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\uiautomation.py", line 6193, in DoubleClick
    x, y = self.MoveCursorToInnerPos(x, y, ratioX, ratioY, simulateMove)
    ^^^^
TypeError: cannot unpack non-iterable NoneType object
2025-04-04 22:07:49 [INFO] - === 微信AI助手退出，退出码: 0 ===
2025-04-04 23:32:37 [INFO] - 全局异常处理器已安装
2025-04-04 23:32:37 [INFO] - === 微信AI助手启动 ===
2025-04-04 23:32:37 [INFO] - 初始化主应用程序
2025-04-04 23:32:37 [INFO] - 设置UI事件处理器完成
2025-04-04 23:32:37 [INFO] - 显示主窗口
2025-04-04 23:32:38 [INFO] - 进入应用程序主循环
2025-04-04 23:34:36 [INFO] - === 微信AI助手退出，退出码: 0 ===
2025-04-04 23:37:57 [INFO] - 全局异常处理器已安装
2025-04-04 23:37:57 [INFO] - === 微信AI助手启动 ===
2025-04-04 23:37:57 [INFO] - 初始化主应用程序
2025-04-04 23:37:57 [INFO] - 设置UI事件处理器完成
2025-04-04 23:37:57 [INFO] - 显示主窗口
2025-04-04 23:37:58 [INFO] - 进入应用程序主循环
2025-04-04 23:37:59 [INFO] - === 微信AI助手退出，退出码: 0 ===
2025-04-04 23:44:21 [INFO] - 全局异常处理器已安装
2025-04-04 23:44:21 [INFO] - === 微信AI助手启动 ===
2025-04-04 23:44:21 [INFO] - 初始化主应用程序
2025-04-04 23:44:21 [INFO] - 设置UI事件处理器完成
2025-04-04 23:44:21 [INFO] - 显示主窗口
2025-04-04 23:44:21 [INFO] - 进入应用程序主循环
2025-04-04 23:44:27 [INFO] - 开始启动监控
2025-04-04 23:44:27 [INFO] - 初始化微信处理器
2025-04-04 23:44:28 [INFO] - 微信处理器初始化完成
2025-04-04 23:44:28 [INFO] - 初始化AI处理器
2025-04-04 23:44:28 [INFO] - 开始配置AI服务...
2025-04-04 23:44:28 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-04 23:44:28 [INFO] - AI服务配置完成
2025-04-04 23:44:28 [INFO] - 连接微信客户端
2025-04-04 23:44:28 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-04 23:44:28 [INFO] - 已连接微信账号: 上下左右
2025-04-04 23:44:28 [INFO] - 创建消息监控器
2025-04-04 23:44:28 [INFO] - 消息监控器初始化完成
2025-04-04 23:44:31 [INFO] - 设置微信监听
2025-04-04 23:44:31 [INFO] - 开始设置 1 个监听目标
2025-04-04 23:44:31 [CRITICAL] - 未捕获的异常: WeChatHandler.setup_listeners.<locals>._setup_listener() missing 1 required positional argument: 'target'
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\src\exception_handler.py", line 64, in patched_thread_run
    original_thread_run(*args, **kwargs)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: WeChatHandler.setup_listeners.<locals>._setup_listener() missing 1 required positional argument: 'target'
2025-04-04 23:44:36 [INFO] - 监听设置完成，成功添加 0 个目标
2025-04-04 23:44:36 [INFO] - 未设置特定监听目标，监听所有聊天
2025-04-04 23:44:36 [INFO] - 启动消息监控线程
2025-04-04 23:44:36 [INFO] - 监控已成功启动
2025-04-04 23:44:36 [INFO] - 消息监控线程启动
2025-04-04 23:44:36 [WARNING] - Qt警告: QObject::setParent: Cannot set parent, new parent is in a different thread
2025-04-04 23:44:42 [WARNING] - Qt警告: QObject::setParent: Cannot set parent, new parent is in a different thread
2025-04-04 23:45:03 [INFO] - 全局异常处理器已安装
2025-04-04 23:45:03 [INFO] - === 微信AI助手启动 ===
2025-04-04 23:45:03 [INFO] - 初始化主应用程序
2025-04-04 23:45:03 [INFO] - 设置UI事件处理器完成
2025-04-04 23:45:03 [INFO] - 显示主窗口
2025-04-04 23:45:04 [INFO] - 进入应用程序主循环
2025-04-04 23:45:06 [INFO] - 开始启动监控
2025-04-04 23:45:06 [INFO] - 初始化微信处理器
2025-04-04 23:45:07 [INFO] - 微信处理器初始化完成
2025-04-04 23:45:07 [INFO] - 初始化AI处理器
2025-04-04 23:45:07 [INFO] - 开始配置AI服务...
2025-04-04 23:45:07 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-04 23:45:07 [INFO] - AI服务配置完成
2025-04-04 23:45:07 [INFO] - 连接微信客户端
2025-04-04 23:45:07 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-04 23:45:07 [INFO] - 已连接微信账号: 上下左右
2025-04-04 23:45:07 [INFO] - 创建消息监控器
2025-04-04 23:45:07 [INFO] - 消息监控器初始化完成
2025-04-04 23:45:08 [INFO] - 设置微信监听
2025-04-04 23:45:08 [INFO] - 开始设置 1 个监听目标
2025-04-04 23:45:08 [CRITICAL] - 未捕获的异常: WeChatHandler.setup_listeners.<locals>._setup_listener() missing 1 required positional argument: 'target'
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\src\exception_handler.py", line 64, in patched_thread_run
    original_thread_run(*args, **kwargs)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: WeChatHandler.setup_listeners.<locals>._setup_listener() missing 1 required positional argument: 'target'
2025-04-04 23:45:13 [INFO] - 监听设置完成，成功添加 0 个目标
2025-04-04 23:45:13 [INFO] - 未设置特定监听目标，监听所有聊天
2025-04-04 23:45:13 [INFO] - 启动消息监控线程
2025-04-04 23:45:13 [INFO] - 监控已成功启动
2025-04-04 23:45:13 [INFO] - 消息监控线程启动
2025-04-04 23:46:03 [INFO] - 全局异常处理器已安装
2025-04-04 23:46:03 [INFO] - === 微信AI助手启动 ===
2025-04-04 23:46:03 [INFO] - 初始化主应用程序
2025-04-04 23:46:03 [INFO] - 设置UI事件处理器完成
2025-04-04 23:46:03 [INFO] - 显示主窗口
2025-04-04 23:46:04 [INFO] - 进入应用程序主循环
2025-04-04 23:46:07 [INFO] - 开始启动监控
2025-04-04 23:46:07 [INFO] - 初始化微信处理器
2025-04-04 23:46:08 [INFO] - 微信处理器初始化完成
2025-04-04 23:46:08 [INFO] - 初始化AI处理器
2025-04-04 23:46:08 [INFO] - 开始配置AI服务...
2025-04-04 23:46:08 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-04 23:46:08 [INFO] - AI服务配置完成
2025-04-04 23:46:08 [INFO] - 连接微信客户端
2025-04-04 23:46:08 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-04 23:46:08 [INFO] - 已连接微信账号: 上下左右
2025-04-04 23:46:08 [INFO] - 创建消息监控器
2025-04-04 23:46:08 [INFO] - 消息监控器初始化完成
2025-04-04 23:46:09 [INFO] - 设置微信监听
2025-04-04 23:46:09 [INFO] - 开始设置 1 个监听目标
2025-04-04 23:46:09 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-04 23:46:09 [WARNING] - Qt警告: QObject::connect: Cannot queue arguments of type 'QTextCursor'
(Make sure 'QTextCursor' is registered using qRegisterMetaType().)
2025-04-04 23:46:14 [INFO] - 监听设置完成，成功添加 0 个目标
2025-04-04 23:46:14 [INFO] - 未设置特定监听目标，监听所有聊天
2025-04-04 23:46:14 [INFO] - 启动消息监控线程
2025-04-04 23:46:14 [INFO] - 监控已成功启动
2025-04-04 23:46:14 [INFO] - 消息监控线程启动
2025-04-04 23:46:22.076 wxauto.py[574] AddListenChat -> Can not move cursor. ListItemControl's BoundingRectangle is (0,0,0,0)[0x0]. SearchProperties: {RegexName: '文件传输助手', ControlType: ListItemControl}
2025-04-04 23:46:22 [ERROR] - 添加监听目标 文件传输助手 失败: cannot unpack non-iterable NoneType object
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\src\wechat_handler.py", line 120, in _setup_listener
    self.wx.AddListenChat(target, savepic=True, savefile=True, savevoice=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\wxauto.py", line 574, in AddListenChat
    self.SessionBox.ListItemControl(RegexName=who).DoubleClick(simulateMove=False)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\uiautomation.py", line 6193, in DoubleClick
    x, y = self.MoveCursorToInnerPos(x, y, ratioX, ratioY, simulateMove)
    ^^^^
TypeError: cannot unpack non-iterable NoneType object
2025-04-04 23:46:22 [WARNING] - Qt警告: QObject::setParent: Cannot set parent, new parent is in a different thread
2025-04-04 23:46:22 [WARNING] - Qt警告: QObject::setParent: Cannot set parent, new parent is in a different thread
2025-04-04 23:46:34 [INFO] - 全局异常处理器已安装
2025-04-04 23:46:34 [INFO] - === 微信AI助手启动 ===
2025-04-04 23:46:34 [INFO] - 初始化主应用程序
2025-04-04 23:46:34 [INFO] - 设置UI事件处理器完成
2025-04-04 23:46:34 [INFO] - 显示主窗口
2025-04-04 23:46:34 [INFO] - 进入应用程序主循环
2025-04-04 23:46:36 [INFO] - 开始启动监控
2025-04-04 23:46:36 [INFO] - 初始化微信处理器
2025-04-04 23:46:37 [INFO] - 微信处理器初始化完成
2025-04-04 23:46:37 [INFO] - 初始化AI处理器
2025-04-04 23:46:37 [INFO] - 开始配置AI服务...
2025-04-04 23:46:37 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-04 23:46:37 [INFO] - AI服务配置完成
2025-04-04 23:46:37 [INFO] - 连接微信客户端
2025-04-04 23:46:37 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-04 23:46:37 [INFO] - 已连接微信账号: 上下左右
2025-04-04 23:46:37 [INFO] - 创建消息监控器
2025-04-04 23:46:37 [INFO] - 消息监控器初始化完成
2025-04-04 23:46:38 [INFO] - 设置微信监听
2025-04-04 23:46:38 [INFO] - 开始设置 1 个监听目标
2025-04-04 23:46:38 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-04 23:46:38 [WARNING] - Qt警告: QObject::connect: Cannot queue arguments of type 'QTextCursor'
(Make sure 'QTextCursor' is registered using qRegisterMetaType().)
2025-04-04 23:46:43 [INFO] - 监听设置完成，成功添加 0 个目标
2025-04-04 23:46:43 [INFO] - 未设置特定监听目标，监听所有聊天
2025-04-04 23:46:43 [INFO] - 启动消息监控线程
2025-04-04 23:46:43 [INFO] - 监控已成功启动
2025-04-04 23:46:43 [INFO] - 消息监控线程启动
2025-04-04 23:46:44 [INFO] - 成功添加监听目标: 文件传输助手
2025-04-04 23:47:01 [INFO] - 从 文件传输助手 获取到 2 条新消息
2025-04-04 23:47:01 [INFO] - 收到来自 文件传输助手 的消息: 23:47
2025-04-04 23:47:01 [INFO] - 收到来自 文件传输助手 的消息: 123
2025-04-04 23:47:01 [INFO] - 已缓存来自 文件传输助手 的消息: 123
2025-04-04 23:47:04 [INFO] - 开始处理来自 文件传输助手 的消息组合
2025-04-04 23:47:04 [INFO] - 开始处理消息: 用户发送了以下多条消息：
用户: 123
请统一回复这些消息。
2025-04-04 23:47:04 [INFO] - 使用模型 deepseek-ai/DeepSeek-R1-Distill-Qwen-7B 发送请求
2025-04-04 23:47:06 [INFO] - 收到AI响应: 收到您的信息了，请问您需要我做什么呢？
2025-04-04 23:47:06 [INFO] - 收到AI回复: 收到您的信息了，请问您需要我做什么呢？
2025-04-04 23:47:06 [INFO] - 尝试发送消息到 文件传输助手: 收到您的信息了，请问您需要我做什么呢？
2025-04-04 23:47:08 [INFO] - 成功发送消息到 文件传输助手
2025-04-04 23:47:08 [INFO] - 已成功发送回复到 文件传输助手
2025-04-04 23:47:09 [INFO] - 从 文件传输助手 获取到 1 条新消息
2025-04-04 23:47:09 [INFO] - 收到来自 文件传输助手 的消息: 收到您的信息了，请问您需要我做什么呢？
2025-04-04 23:47:09 [INFO] - 跳过缓存AI回复内容: 收到您的信息了，请问您需要我做什么呢？
2025-04-04 23:47:25 [INFO] - === 微信AI助手退出，退出码: 0 ===
2025-04-04 23:47:39 [INFO] - 全局异常处理器已安装
2025-04-04 23:47:39 [INFO] - === 微信AI助手启动 ===
2025-04-04 23:47:39 [INFO] - 初始化主应用程序
2025-04-04 23:47:39 [INFO] - 设置UI事件处理器完成
2025-04-04 23:47:39 [INFO] - 显示主窗口
2025-04-04 23:47:40 [INFO] - 进入应用程序主循环
2025-04-04 23:47:42 [INFO] - 开始启动监控
2025-04-04 23:47:42 [INFO] - 初始化微信处理器
2025-04-04 23:47:42 [INFO] - 微信处理器初始化完成
2025-04-04 23:47:42 [INFO] - 初始化AI处理器
2025-04-04 23:47:42 [INFO] - 开始配置AI服务...
2025-04-04 23:47:42 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-04 23:47:42 [INFO] - AI服务配置完成
2025-04-04 23:47:42 [INFO] - 连接微信客户端
2025-04-04 23:47:42 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-04 23:47:42 [INFO] - 已连接微信账号: 上下左右
2025-04-04 23:47:42 [INFO] - 创建消息监控器
2025-04-04 23:47:42 [INFO] - 消息监控器初始化完成
2025-04-04 23:47:46 [INFO] - 设置微信监听
2025-04-04 23:47:46 [INFO] - 开始设置 1 个监听目标
2025-04-04 23:47:46 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-04 23:47:46 [WARNING] - Qt警告: QObject::connect: Cannot queue arguments of type 'QTextCursor'
(Make sure 'QTextCursor' is registered using qRegisterMetaType().)
2025-04-04 23:47:51 [INFO] - 监听设置完成，成功添加 0 个目标
2025-04-04 23:47:51 [INFO] - 未设置特定监听目标，监听所有聊天
2025-04-04 23:47:51 [INFO] - 启动消息监控线程
2025-04-04 23:47:51 [INFO] - 监控已成功启动
2025-04-04 23:47:51 [INFO] - 消息监控线程启动
2025-04-04 23:47:51 [INFO] - 成功添加监听目标: 文件传输助手
2025-04-04 23:48:05 [INFO] - 从 文件传输助手 获取到 1 条新消息
2025-04-04 23:48:05 [INFO] - 收到来自 文件传输助手 的消息: 963
2025-04-04 23:48:05 [INFO] - 已缓存来自 文件传输助手 的消息: 963
2025-04-04 23:48:09 [INFO] - 开始处理来自 文件传输助手 的消息组合
2025-04-04 23:48:09 [INFO] - 开始处理消息: 用户发送了以下多条消息：
用户: 963
请统一回复这些消息。
2025-04-04 23:48:09 [INFO] - 使用模型 deepseek-ai/DeepSeek-R1-Distill-Qwen-7B 发送请求
2025-04-04 23:48:11 [INFO] - 收到AI响应: 963：好的，有什么我可以帮助你的吗？
2025-04-04 23:48:11 [INFO] - 收到AI回复: 963：好的，有什么我可以帮助你的吗？
2025-04-04 23:48:11 [INFO] - 尝试发送消息到 文件传输助手: 963：好的，有什么我可以帮助你的吗？
2025-04-04 23:48:14 [INFO] - 成功发送消息到 文件传输助手
2025-04-04 23:48:14 [INFO] - 已成功发送回复到 文件传输助手
2025-04-04 23:48:14 [INFO] - 从 文件传输助手 获取到 1 条新消息
2025-04-04 23:48:14 [INFO] - 收到来自 文件传输助手 的消息: 963：好的，有什么我可以帮助你的吗？
2025-04-04 23:48:14 [INFO] - 跳过缓存AI回复内容: 963：好的，有什么我可以帮助你的吗？
2025-04-04 23:49:42 [INFO] - 停止监控
2025-04-04 23:49:42 [INFO] - 停止消息监控线程
2025-04-04 23:49:42 [INFO] - 消息监控线程已停止
2025-04-04 23:49:42 [INFO] - 开始清理所有监听目标
2025-04-04 23:49:42 [INFO] - 尝试移除监听目标: 文件传输助手
2025-04-04 23:49:50 [INFO] - 成功移除监听目标: 文件传输助手
2025-04-04 23:49:50 [INFO] - 所有监听目标已清理完成
2025-04-04 23:49:50 [INFO] - 微信监听已清理
2025-04-04 23:49:50 [INFO] - 监控已完全停止
2025-04-04 23:49:53 [INFO] - 开始启动监控
2025-04-04 23:49:53 [INFO] - 初始化微信处理器
2025-04-04 23:49:55 [INFO] - 微信处理器初始化完成
2025-04-04 23:49:55 [INFO] - 初始化AI处理器
2025-04-04 23:49:55 [INFO] - 开始配置AI服务...
2025-04-04 23:49:55 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-04 23:49:55 [INFO] - AI服务配置完成
2025-04-04 23:49:55 [INFO] - 连接微信客户端
2025-04-04 23:49:55 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-04 23:49:55 [INFO] - 已连接微信账号: 上下左右
2025-04-04 23:49:55 [INFO] - 创建消息监控器
2025-04-04 23:49:55 [INFO] - 消息监控器初始化完成
2025-04-04 23:49:57 [INFO] - 设置微信监听
2025-04-04 23:49:57 [INFO] - 开始设置 1 个监听目标
2025-04-04 23:49:57 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-04 23:50:02 [INFO] - 监听设置完成，成功添加 0 个目标
2025-04-04 23:50:02 [INFO] - 未设置特定监听目标，监听所有聊天
2025-04-04 23:50:02 [INFO] - 启动消息监控线程
2025-04-04 23:50:02 [INFO] - 监控已成功启动
2025-04-04 23:50:02 [INFO] - 消息监控线程启动
2025-04-04 23:50:07 [ERROR] - 添加监听目标 文件传输助手 失败: list index out of range
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\src\wechat_handler.py", line 120, in _setup_listener
    self.wx.AddListenChat(target, savepic=True, savefile=True, savevoice=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\wxauto.py", line 573, in AddListenChat
    self.ChatWith(who)
    ~~~~~~~~~~~~~^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\wxauto.py", line 327, in ChatWith
    search_result_control = self.SessionBox.GetChildren()[1].GetChildren()[1].GetFirstChildControl()
                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
IndexError: list index out of range
2025-04-04 23:50:07 [WARNING] - Qt警告: QObject::setParent: Cannot set parent, new parent is in a different thread
2025-04-05 00:03:23 [INFO] - 全局异常处理器已安装
2025-04-05 00:03:23 [INFO] - === 微信AI助手启动 ===
2025-04-05 00:03:23 [INFO] - 初始化主应用程序
2025-04-05 00:03:23 [INFO] - 设置UI事件处理器完成
2025-04-05 00:03:23 [INFO] - 显示主窗口
2025-04-05 00:03:23 [INFO] - 进入应用程序主循环
2025-04-05 00:03:29 [INFO] - 开始启动监控
2025-04-05 00:03:29 [INFO] - 初始化微信处理器
2025-04-05 00:03:30 [INFO] - 微信处理器初始化完成
2025-04-05 00:03:30 [INFO] - 初始化AI处理器
2025-04-05 00:03:30 [INFO] - 开始配置AI服务...
2025-04-05 00:03:30 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-05 00:03:30 [INFO] - AI服务配置完成
2025-04-05 00:03:30 [INFO] - 连接微信客户端
2025-04-05 00:03:30 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-05 00:03:30 [INFO] - 已连接微信账号: 上下左右
2025-04-05 00:03:30 [INFO] - 创建消息监控器
2025-04-05 00:03:30 [INFO] - 消息监控器初始化完成
2025-04-05 00:03:30 [INFO] - 创建监听设置线程
2025-04-05 00:03:30 [INFO] - 设置微信监听
2025-04-05 00:03:30 [INFO] - 开始设置 2 个监听目标
2025-04-05 00:03:30 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-05 00:03:30 [WARNING] - Qt警告: QObject::connect: Cannot queue arguments of type 'QTextCursor'
(Make sure 'QTextCursor' is registered using qRegisterMetaType().)
2025-04-05 00:03:30 [INFO] - 尝试添加监听目标: 微信支付
2025-04-05 00:03:31 [INFO] - 成功添加监听目标: 文件传输助手
2025-04-05 00:03:31 [INFO] - 成功添加监听目标: 微信支付
2025-04-05 00:03:31 [INFO] - 监听设置完成，成功添加 2 个目标
2025-04-05 00:03:31 [INFO] - 成功监听目标: 文件传输助手, 微信支付
2025-04-05 00:03:31 [INFO] - 更新监听目标: 文件传输助手, 微信支付
2025-04-05 00:03:31 [INFO] - 启动消息监控线程
2025-04-05 00:03:31 [INFO] - 监控已成功启动
2025-04-05 00:03:31 [INFO] - 消息监控线程启动
2025-04-05 00:03:38 [INFO] - 从 文件传输助手 获取到 2 条新消息
2025-04-05 00:03:39 [INFO] - 收到来自 文件传输助手 的消息: 0:03
2025-04-05 00:03:39 [INFO] - 收到来自 文件传输助手 的消息: 63
2025-04-05 00:03:39 [INFO] - 已缓存来自 文件传输助手 的消息: 63
2025-04-05 00:03:43 [INFO] - 开始处理来自 文件传输助手 的消息组合
2025-04-05 00:03:43 [INFO] - 开始处理消息: 用户发送了以下多条消息：
用户: 63
请统一回复这些消息。
2025-04-05 00:03:43 [INFO] - 使用模型 deepseek-ai/DeepSeek-R1-Distill-Qwen-7B 发送请求
2025-04-05 00:03:45 [INFO] - 收到AI响应: 数字63有什么特别的含义吗？或者您需要帮助处理与之相关的事情？
2025-04-05 00:03:45 [INFO] - 收到AI回复: 数字63有什么特别的含义吗？或者您需要帮助处理与之相关的事情？
2025-04-05 00:03:45 [INFO] - 尝试发送消息到 文件传输助手: 数字63有什么特别的含义吗？或者您需要帮助处理与之相关的事情？
2025-04-05 00:03:45 [INFO] - 停止监控
2025-04-05 00:03:45 [INFO] - 停止消息监控线程
2025-04-05 00:03:48 [INFO] - 成功发送消息到 文件传输助手
2025-04-05 00:03:48 [INFO] - 已成功发送回复到 文件传输助手
2025-04-05 00:03:48 [INFO] - 消息监控线程已停止
2025-04-05 00:03:48 [INFO] - 开始清理所有监听目标
2025-04-05 00:03:48 [INFO] - 尝试移除监听目标: 文件传输助手
2025-04-05 00:03:56 [INFO] - 成功移除监听目标: 文件传输助手
2025-04-05 00:03:56 [INFO] - 尝试移除监听目标: 微信支付
2025-04-05 00:04:03 [INFO] - 成功移除监听目标: 微信支付
2025-04-05 00:04:03 [INFO] - 所有监听目标已清理完成
2025-04-05 00:04:03 [INFO] - 微信监听已清理
2025-04-05 00:04:03 [INFO] - 监控已完全停止
2025-04-05 00:04:09 [INFO] - 停止监控
2025-04-05 00:04:09 [INFO] - 停止消息监控线程
2025-04-05 00:04:09 [INFO] - 消息监控线程已停止
2025-04-05 00:04:09 [INFO] - 开始清理所有监听目标
2025-04-05 00:04:09 [INFO] - 所有监听目标已清理完成
2025-04-05 00:04:09 [INFO] - 微信监听已清理
2025-04-05 00:04:09 [INFO] - 监控已完全停止
2025-04-05 00:04:21 [INFO] - 开始启动监控
2025-04-05 00:04:21 [INFO] - 初始化微信处理器
2025-04-05 00:04:22 [INFO] - 微信处理器初始化完成
2025-04-05 00:04:22 [INFO] - 初始化AI处理器
2025-04-05 00:04:22 [INFO] - 开始配置AI服务...
2025-04-05 00:04:22 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-05 00:04:22 [INFO] - AI服务配置完成
2025-04-05 00:04:22 [INFO] - 连接微信客户端
2025-04-05 00:04:22 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-05 00:04:22 [INFO] - 已连接微信账号: 上下左右
2025-04-05 00:04:22 [INFO] - 创建消息监控器
2025-04-05 00:04:22 [INFO] - 消息监控器初始化完成
2025-04-05 00:04:23 [INFO] - 创建监听设置线程
2025-04-05 00:04:23 [INFO] - 设置微信监听
2025-04-05 00:04:23 [INFO] - 开始设置 2 个监听目标
2025-04-05 00:04:23 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-05 00:04:23 [INFO] - 尝试添加监听目标: 微信支付
2025-04-05 00:04:26 [INFO] - 成功添加监听目标: 微信支付
2025-04-05 00:04:28 [INFO] - 监听设置完成，成功添加 1 个目标
2025-04-05 00:04:28 [INFO] - 成功监听目标: 微信支付
2025-04-05 00:04:28 [INFO] - 更新监听目标: 微信支付
2025-04-05 00:04:28 [INFO] - 启动消息监控线程
2025-04-05 00:04:28 [INFO] - 监控已成功启动
2025-04-05 00:04:28 [INFO] - 消息监控线程启动
2025-04-05 00:04:36 [ERROR] - 添加监听目标 文件传输助手 失败: Find Control Timeout: {ControlType: ListControl}
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\src\wechat_handler.py", line 120, in _setup_listener
    self.wx.AddListenChat(target, savepic=True, savefile=True, savevoice=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\wxauto.py", line 575, in AddListenChat
    self.listen[who] = ChatWnd(who, self.language)
                       ~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\elements.py", line 188, in __init__
    self.GetAllMessage()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\elements.py", line 314, in GetAllMessage
    MsgItems = self.C_MsgList.GetChildren()
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\uiautomation.py", line 5960, in GetChildren
    child = self.GetFirstChildControl()
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\uiautomation.py", line 5855, in GetFirstChildControl
    ele = _AutomationClient.instance().ViewWalker.GetFirstChildElement(self.Element)
                                                                       ^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\uiautomation.py", line 5788, in Element
    self.Refind(maxSearchSeconds=TIME_OUT_SECOND, searchIntervalSeconds=self.searchInterval)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\uiautomation.py", line 6087, in Refind
    raise LookupError('Find Control Timeout: ' + self.GetSearchPropertiesStr())
LookupError: Find Control Timeout: {ControlType: ListControl}
2025-04-05 00:04:36 [WARNING] - Qt警告: QObject::setParent: Cannot set parent, new parent is in a different thread
2025-04-05 00:04:36 [WARNING] - Qt警告: QObject::setParent: Cannot set parent, new parent is in a different thread
2025-04-05 00:06:26 [INFO] - 全局异常处理器已安装
2025-04-05 00:06:26 [INFO] - === 微信AI助手启动 ===
2025-04-05 00:06:26 [INFO] - 初始化主应用程序
2025-04-05 00:06:26 [INFO] - 设置UI事件处理器完成
2025-04-05 00:06:26 [INFO] - 显示主窗口
2025-04-05 00:06:26 [INFO] - 进入应用程序主循环
2025-04-05 00:06:30 [INFO] - 开始启动监控
2025-04-05 00:06:30 [INFO] - 初始化微信处理器
2025-04-05 00:06:31 [INFO] - 微信处理器初始化完成
2025-04-05 00:06:31 [INFO] - 初始化AI处理器
2025-04-05 00:06:31 [INFO] - 开始配置AI服务...
2025-04-05 00:06:31 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-05 00:06:31 [INFO] - AI服务配置完成
2025-04-05 00:06:31 [INFO] - 连接微信客户端
2025-04-05 00:06:31 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-05 00:06:31 [INFO] - 已连接微信账号: 上下左右
2025-04-05 00:06:31 [INFO] - 创建消息监控器
2025-04-05 00:06:31 [INFO] - 消息监控器初始化完成
2025-04-05 00:06:33 [INFO] - 创建监听设置线程
2025-04-05 00:06:33 [INFO] - 设置微信监听
2025-04-05 00:06:33 [INFO] - 线程开始设置微信监听
2025-04-05 00:06:33 [INFO] - 开始设置 2 个监听目标
2025-04-05 00:06:33 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-05 00:06:33 [WARNING] - Qt警告: QObject::connect: Cannot queue arguments of type 'QTextCursor'
(Make sure 'QTextCursor' is registered using qRegisterMetaType().)
2025-04-05 00:06:45 [INFO] - 成功添加监听目标: 文件传输助手
2025-04-05 00:06:45 [INFO] - 尝试添加监听目标: 微信支付
2025-04-05 00:06:58 [INFO] - 成功添加监听目标: 微信支付
2025-04-05 00:06:58 [INFO] - 监听设置完成，成功添加 2 个目标
2025-04-05 00:06:58 [INFO] - 线程成功设置监听: ['文件传输助手', '微信支付']
2025-04-05 00:06:58 [INFO] - 成功监听目标: 文件传输助手, 微信支付
2025-04-05 00:06:58 [INFO] - 更新监听目标: 文件传输助手, 微信支付
2025-04-05 00:06:58 [INFO] - 启动消息监控线程
2025-04-05 00:06:58 [INFO] - 监控已成功启动
2025-04-05 00:06:58 [INFO] - 消息监控线程启动
2025-04-05 00:07:00 [INFO] - 从 微信支付 获取到 28 条新消息
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 星期二 17:03
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 您好呀，是不是遇到了什么不太明白的事情呢？能和我多说一说吗？
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 您好呀，是不是遇到了什么不太明白的事情呢？能和我多说一说吗？
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 很高兴为您重新表述！请问您需要什么样的帮助？我们会尽力为您解答问题。
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 很高兴为您重新表述！请问您需要什么样的帮助？我们会尽力为您解答问题。
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 为了更准确地为您提供帮助，请您详细阐述一下所遇到的问题。
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 为了更准确地为您提供帮助，请您详细阐述一下所遇到的问题。
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 当然，请您具体描述一下您所遇到的问题。
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 当然，请您具体描述一下您所遇到的问题。
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 具体是什么问题呢，您可以告诉我的。
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 具体是什么问题呢，您可以告诉我的。
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 星期二 17:09
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 你好
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 你好
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 您好，很高兴认识您~
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 您好，很高兴认识您~
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 1111
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 1111
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 我注意到您似乎有些疑问，能否具体说明一下您所遇到的情况？
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 我注意到您似乎有些疑问，能否具体说明一下您所遇到的情况？
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 星期二 20:22
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 星期二 22:42
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 你好你好
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 你好你好
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 您好，很高兴认识您~
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 您好，很高兴认识您~
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 很高兴为你服务！
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 很高兴为你服务！
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 您的夸赞就是我最大的动力。
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 您的夸赞就是我最大的动力。
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 星期三 10:46
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 昨天 10:46
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 昨天 23:54
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 你好你好
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 你好你好
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 您好~美好的一天开始啦。
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 您好~美好的一天开始啦。
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 你好！美好的一天已经开始啦！希望今天对你来说也是个好天气，工作顺利，生活愉快！
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 你好！美好的一天已经开始啦！希望今天对你来说也是个好天气，工作顺利，生活愉快！
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 我在这里随时准备帮您解决问题，能不能把您遇到的情况详细说说呢？
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 我在这里随时准备帮您解决问题，能不能把您遇到的情况详细说说呢？
2025-04-05 00:07:00 [INFO] - 收到来自 微信支付 的消息: 当然可以！请随时告诉我您遇到的问题，我会尽力为您提供帮助。
2025-04-05 00:07:00 [INFO] - 已缓存来自 微信支付 的消息: 当然可以！请随时告诉我您遇到的问题，我会尽力为您提供帮助。
2025-04-05 00:07:03 [INFO] - 开始处理来自 微信支付 的消息组合
2025-04-05 00:07:03 [INFO] - 开始处理消息: 用户发送了以下多条消息：
用户: 您好呀，是不是遇到了什么不太明白的事情呢？能和我多说一说吗？
用户: 很高兴为您重新表述！请问您需要什么样的帮助？我们会尽力为您解答问题。
用户: 为了更准确地为您提...
2025-04-05 00:07:03 [INFO] - 使用模型 deepseek-ai/DeepSeek-R1-Distill-Qwen-7B 发送请求
2025-04-05 00:07:06 [INFO] - 收到AI响应: 您好！很高兴认识您。请问有什么我可以帮助您的吗？如果您有任何问题或需要帮助的地方，请随时告诉我，我会尽力为您解答。
2025-04-05 00:07:06 [INFO] - 收到AI回复: 您好！很高兴认识您。请问有什么我可以帮助您的吗？如果您有任何问题或需要帮助的地方，请随时告诉我，我会尽力为您解答。
2025-04-05 00:07:06 [INFO] - 尝试发送消息到 微信支付: 您好！很高兴认识您。请问有什么我可以帮助您的吗？如果您有任何问题或需要帮助的地方，请随时告诉我，我会...
2025-04-05 00:07:10 [INFO] - 停止监控
2025-04-05 00:07:10 [INFO] - 停止消息监控线程
2025-04-05 00:07:18 [ERROR] - 发送消息到 微信支付 失败: Find Control Timeout: {ControlType: EditControl}
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\src\wechat_handler.py", line 185, in send_message
    self.wx.SendMsg(message, who=target)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\wxauto.py", line 386, in SendMsg
    chat.SendMsg(msg, at=at)
    ~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\elements.py", line 233, in SendMsg
    if not self.editbox.HasKeyboardFocus:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\uiautomation.py", line 5534, in HasKeyboardFocus
    return bool(self.Element.CurrentHasKeyboardFocus)
                ^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\uiautomation.py", line 5788, in Element
    self.Refind(maxSearchSeconds=TIME_OUT_SECOND, searchIntervalSeconds=self.searchInterval)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\uiautomation.py", line 6087, in Refind
    raise LookupError('Find Control Timeout: ' + self.GetSearchPropertiesStr())
LookupError: Find Control Timeout: {ControlType: EditControl}
2025-04-05 00:07:18 [ERROR] - AI处理失败: name 'nickname' is not defined
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\src\wechat_handler.py", line 185, in send_message
    self.wx.SendMsg(message, who=target)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\wxauto.py", line 386, in SendMsg
    chat.SendMsg(msg, at=at)
    ~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\elements.py", line 233, in SendMsg
    if not self.editbox.HasKeyboardFocus:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\uiautomation.py", line 5534, in HasKeyboardFocus
    return bool(self.Element.CurrentHasKeyboardFocus)
                ^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\uiautomation.py", line 5788, in Element
    self.Refind(maxSearchSeconds=TIME_OUT_SECOND, searchIntervalSeconds=self.searchInterval)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\uiautomation.py", line 6087, in Refind
    raise LookupError('Find Control Timeout: ' + self.GetSearchPropertiesStr())
LookupError: Find Control Timeout: {ControlType: EditControl}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\main.py", line 80, in check_and_process_messages
    if self.wechat.send_message(ai_response, sender):
       ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\src\wechat_handler.py", line 193, in send_message
    'content': f'已连接到微信账号: {nickname}',
                                    ^^^^^^^^
NameError: name 'nickname' is not defined
2025-04-05 00:07:18 [INFO] - 消息监控线程已停止
2025-04-05 00:07:18 [INFO] - 开始清理所有监听目标
2025-04-05 00:07:18 [INFO] - 尝试移除监听目标: 文件传输助手
2025-04-05 00:07:26 [INFO] - 成功移除监听目标: 文件传输助手
2025-04-05 00:07:26 [INFO] - 尝试移除监听目标: 微信支付
2025-04-05 00:07:31 [ERROR] - 移除监听目标 微信支付 失败: list index out of range
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\src\wechat_handler.py", line 74, in remove_listener
    self.wx.ChatWith(target)
    ~~~~~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\wxauto.py", line 327, in ChatWith
    search_result_control = self.SessionBox.GetChildren()[1].GetChildren()[1].GetFirstChildControl()
                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
IndexError: list index out of range
2025-04-05 00:07:31 [INFO] - 所有监听目标已清理完成
2025-04-05 00:07:31 [INFO] - 微信监听已清理
2025-04-05 00:07:31 [INFO] - 监控已完全停止
2025-04-05 00:26:23 [INFO] - === 微信AI助手退出，退出码: 0 ===
2025-04-05 00:26:25 [INFO] - 全局异常处理器已安装
2025-04-05 00:26:25 [INFO] - === 微信AI助手启动 ===
2025-04-05 00:26:25 [INFO] - 初始化主应用程序
2025-04-05 00:26:25 [INFO] - 设置UI事件处理器完成
2025-04-05 00:26:25 [INFO] - 显示主窗口
2025-04-05 00:26:25 [INFO] - 进入应用程序主循环
2025-04-05 00:26:54 [INFO] - 开始启动监控
2025-04-05 00:26:54 [INFO] - 初始化微信处理器
2025-04-05 00:26:55 [INFO] - 微信处理器初始化完成
2025-04-05 00:26:55 [INFO] - 初始化AI处理器
2025-04-05 00:26:55 [INFO] - 开始配置AI服务...
2025-04-05 00:26:55 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-05 00:26:55 [INFO] - AI服务配置完成
2025-04-05 00:26:55 [INFO] - 连接微信客户端
2025-04-05 00:26:55 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-05 00:26:55 [INFO] - 已连接微信账号: 上下左右
2025-04-05 00:26:55 [INFO] - 创建消息监控器
2025-04-05 00:26:55 [INFO] - 消息监控器初始化完成
2025-04-05 00:26:56 [INFO] - 创建监听设置线程
2025-04-05 00:26:56 [INFO] - 设置微信监听
2025-04-05 00:26:56 [INFO] - 线程开始设置微信监听
2025-04-05 00:26:56 [INFO] - 开始设置 2 个监听目标
2025-04-05 00:26:56 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-05 00:26:56 [WARNING] - Qt警告: QObject::connect: Cannot queue arguments of type 'QTextCursor'
(Make sure 'QTextCursor' is registered using qRegisterMetaType().)
2025-04-05 00:26:56 [INFO] - 成功添加监听目标: 文件传输助手
2025-04-05 00:26:56 [INFO] - 尝试添加监听目标: 微信支付
2025-04-05 00:26:57 [INFO] - 成功添加监听目标: 微信支付
2025-04-05 00:26:57 [INFO] - 监听设置完成，成功添加 2 个目标
2025-04-05 00:26:57 [INFO] - 线程成功设置监听: ['文件传输助手', '微信支付']
2025-04-05 00:26:57 [INFO] - 成功监听目标: 文件传输助手, 微信支付
2025-04-05 00:26:57 [INFO] - 更新监听目标: 文件传输助手, 微信支付
2025-04-05 00:26:57 [INFO] - 启动消息监控线程
2025-04-05 00:26:57 [INFO] - 监控已成功启动
2025-04-05 00:26:57 [INFO] - 消息监控线程启动
2025-04-05 00:27:05 [INFO] - 停止监控
2025-04-05 00:27:05 [INFO] - 停止消息监控线程
2025-04-05 00:27:05 [INFO] - 停止消息监控线程
2025-04-05 00:27:05 [ERROR] - 停止监控时出错: arguments did not match any overloaded call:
  wait(self, msecs: int = ULONG_MAX): 'timeout' is not a valid keyword argument
  wait(self, deadline: QDeadlineTimer): 'timeout' is not a valid keyword argument
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\main.py", line 321, in run
    self.monitor.wait(timeout=3000)  # 最多等待3秒
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
TypeError: arguments did not match any overloaded call:
  wait(self, msecs: int = ULONG_MAX): 'timeout' is not a valid keyword argument
  wait(self, deadline: QDeadlineTimer): 'timeout' is not a valid keyword argument
2025-04-05 00:27:05 [INFO] - 监控已完全停止
2025-04-05 00:27:14 [INFO] - 停止监控
2025-04-05 00:27:14 [INFO] - 监控已完全停止
2025-04-05 00:27:27 [INFO] - 开始启动监控
2025-04-05 00:27:27 [INFO] - 初始化微信处理器
2025-04-05 00:27:27 [INFO] - 微信处理器初始化完成
2025-04-05 00:27:27 [INFO] - 初始化AI处理器
2025-04-05 00:27:27 [INFO] - 开始配置AI服务...
2025-04-05 00:27:27 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-05 00:27:27 [INFO] - AI服务配置完成
2025-04-05 00:27:27 [INFO] - 连接微信客户端
2025-04-05 00:27:27 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-05 00:27:27 [INFO] - 已连接微信账号: 上下左右
2025-04-05 00:27:27 [INFO] - 创建消息监控器
2025-04-05 00:27:27 [INFO] - 消息监控器初始化完成
2025-04-05 00:27:29 [INFO] - 创建监听设置线程
2025-04-05 00:27:29 [INFO] - 设置微信监听
2025-04-05 00:27:29 [INFO] - 线程开始设置微信监听
2025-04-05 00:27:29 [INFO] - 开始设置 2 个监听目标
2025-04-05 00:27:29 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-05 00:27:30 [INFO] - 成功添加监听目标: 文件传输助手
2025-04-05 00:27:30 [INFO] - 尝试添加监听目标: 微信支付
2025-04-05 00:27:31 [INFO] - 成功添加监听目标: 微信支付
2025-04-05 00:27:31 [INFO] - 监听设置完成，成功添加 2 个目标
2025-04-05 00:27:31 [INFO] - 线程成功设置监听: ['文件传输助手', '微信支付']
2025-04-05 00:27:31 [INFO] - 成功监听目标: 文件传输助手, 微信支付
2025-04-05 00:27:31 [INFO] - 更新监听目标: 文件传输助手, 微信支付
2025-04-05 00:27:31 [INFO] - 启动消息监控线程
2025-04-05 00:27:31 [INFO] - 监控已成功启动
2025-04-05 00:27:31 [INFO] - 消息监控线程启动
2025-04-05 00:27:37 [INFO] - 从 文件传输助手 获取到 2 条新消息
2025-04-05 00:27:38 [INFO] - 收到来自 文件传输助手 的消息: 0:27
2025-04-05 00:27:38 [INFO] - 收到来自 文件传输助手 的消息: 123
2025-04-05 00:27:38 [INFO] - 已缓存来自 文件传输助手 的消息: 123
2025-04-05 00:27:40 [INFO] - 从 文件传输助手 获取到 2 条新消息
2025-04-05 00:27:41 [INFO] - 收到来自 文件传输助手 的消息: 1
2025-04-05 00:27:41 [INFO] - 已缓存来自 文件传输助手 的消息: 1
2025-04-05 00:27:41 [INFO] - 收到来自 文件传输助手 的消息: 1
2025-04-05 00:27:41 [INFO] - 已缓存来自 文件传输助手 的消息: 1
2025-04-05 00:27:45 [INFO] - 开始处理来自 文件传输助手 的消息组合
2025-04-05 00:27:45 [INFO] - 开始处理消息: 用户发送了以下多条消息：
用户: 123
用户: 1
用户: 1
请统一回复这些消息。
2025-04-05 00:27:45 [INFO] - 使用模型 deepseek-ai/DeepSeek-R1-Distill-Qwen-7B 发送请求
2025-04-05 00:27:48 [INFO] - 收到AI响应: 您好！感谢您发送的信息。请问您需要我统一回复这些消息吗？
2025-04-05 00:27:48 [INFO] - 收到AI回复: 您好！感谢您发送的信息。请问您需要我统一回复这些消息吗？
2025-04-05 00:27:48 [INFO] - 尝试发送消息到 文件传输助手: 您好！感谢您发送的信息。请问您需要我统一回复这些消息吗？
2025-04-05 00:27:50 [INFO] - 成功发送消息到 文件传输助手
2025-04-05 00:27:50 [INFO] - 已成功发送回复到 文件传输助手
2025-04-05 00:27:51 [INFO] - 从 文件传输助手 获取到 4 条新消息
2025-04-05 00:27:52 [INFO] - 收到来自 文件传输助手 的消息: 1
2025-04-05 00:27:52 [INFO] - 收到来自 文件传输助手 的消息: 1
2025-04-05 00:27:52 [INFO] - 收到来自 文件传输助手 的消息: 1
2025-04-05 00:27:52 [INFO] - 收到来自 文件传输助手 的消息: 您好！感谢您发送的信息。请问您需要我统一回复这些消息吗？
2025-04-05 00:28:01 [INFO] - 从 文件传输助手 获取到 3 条新消息
2025-04-05 00:28:02 [INFO] - 收到来自 文件传输助手 的消息: 1
2025-04-05 00:28:02 [INFO] - 收到来自 文件传输助手 的消息: 1
2025-04-05 00:28:02 [INFO] - 收到来自 文件传输助手 的消息: 1
2025-04-05 00:28:03 [INFO] - 从 文件传输助手 获取到 2 条新消息
2025-04-05 00:28:03 [INFO] - 收到来自 文件传输助手 的消息: 昨天 23:54
2025-04-05 00:28:03 [INFO] - 收到来自 文件传输助手 的消息: 1
2025-04-05 00:28:13 [INFO] - 停止监控
2025-04-05 00:28:13 [INFO] - 停止消息监控线程
2025-04-05 00:28:13 [INFO] - 停止消息监控线程
2025-04-05 00:28:13 [ERROR] - 停止监控时出错: arguments did not match any overloaded call:
  wait(self, msecs: int = ULONG_MAX): 'timeout' is not a valid keyword argument
  wait(self, deadline: QDeadlineTimer): 'timeout' is not a valid keyword argument
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\main.py", line 321, in run
    self.monitor.wait(timeout=3000)  # 最多等待3秒
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
TypeError: arguments did not match any overloaded call:
  wait(self, msecs: int = ULONG_MAX): 'timeout' is not a valid keyword argument
  wait(self, deadline: QDeadlineTimer): 'timeout' is not a valid keyword argument
2025-04-05 00:28:13 [INFO] - 监控已完全停止
2025-04-05 00:28:32 [INFO] - 停止监控
2025-04-05 00:28:32 [INFO] - 监控已完全停止
2025-04-05 00:30:00 [INFO] - === 微信AI助手退出，退出码: 0 ===
2025-04-05 00:30:01 [INFO] - 全局异常处理器已安装
2025-04-05 00:30:01 [INFO] - === 微信AI助手启动 ===
2025-04-05 00:30:01 [INFO] - 初始化主应用程序
2025-04-05 00:30:01 [INFO] - 设置UI事件处理器完成
2025-04-05 00:30:01 [INFO] - 显示主窗口
2025-04-05 00:30:01 [INFO] - 进入应用程序主循环
2025-04-05 00:30:05 [INFO] - 开始启动监控
2025-04-05 00:30:05 [INFO] - 初始化微信处理器
2025-04-05 00:30:06 [INFO] - 微信处理器初始化完成
2025-04-05 00:30:06 [INFO] - 初始化AI处理器
2025-04-05 00:30:06 [INFO] - 开始配置AI服务...
2025-04-05 00:30:06 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-05 00:30:06 [INFO] - AI服务配置完成
2025-04-05 00:30:06 [INFO] - 连接微信客户端
2025-04-05 00:30:06 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-05 00:30:06 [INFO] - 已连接微信账号: 上下左右
2025-04-05 00:30:06 [INFO] - 创建消息监控器
2025-04-05 00:30:06 [INFO] - 消息监控器初始化完成
2025-04-05 00:30:07 [INFO] - 创建监听设置线程
2025-04-05 00:30:07 [INFO] - 设置微信监听
2025-04-05 00:30:07 [INFO] - 线程开始设置微信监听
2025-04-05 00:30:07 [INFO] - 开始设置 2 个监听目标
2025-04-05 00:30:07 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-05 00:30:07 [WARNING] - Qt警告: QObject::connect: Cannot queue arguments of type 'QTextCursor'
(Make sure 'QTextCursor' is registered using qRegisterMetaType().)
2025-04-05 00:30:07 [INFO] - 成功添加监听目标: 文件传输助手
2025-04-05 00:30:07 [INFO] - 尝试添加监听目标: 微信支付
2025-04-05 00:30:08 [INFO] - 成功添加监听目标: 微信支付
2025-04-05 00:30:08 [INFO] - 监听设置完成，成功添加 2 个目标
2025-04-05 00:30:08 [INFO] - 线程成功设置监听: ['文件传输助手', '微信支付']
2025-04-05 00:30:08 [INFO] - 成功监听目标: 文件传输助手, 微信支付
2025-04-05 00:30:08 [INFO] - 更新监听目标: 文件传输助手, 微信支付
2025-04-05 00:30:08 [INFO] - 启动消息监控线程
2025-04-05 00:30:08 [INFO] - 监控已成功启动
2025-04-05 00:30:08 [INFO] - 消息监控线程启动
2025-04-05 00:30:16 [INFO] - 从 文件传输助手 获取到 1 条新消息
2025-04-05 00:30:17 [INFO] - 收到来自 文件传输助手 的消息: 1
2025-04-05 00:30:21 [INFO] - 从 文件传输助手 获取到 3 条新消息
2025-04-05 00:30:22 [INFO] - 收到来自 文件传输助手 的消息: 1
2025-04-05 00:30:22 [INFO] - 收到来自 文件传输助手 的消息: 1
2025-04-05 00:30:22 [INFO] - 收到来自 文件传输助手 的消息: 1
2025-04-05 00:30:33 [INFO] - 停止监控
2025-04-05 00:30:33 [INFO] - 停止消息监控线程
2025-04-05 00:30:33 [INFO] - 停止消息监控线程
2025-04-05 00:30:34 [INFO] - 消息监控线程已停止
2025-04-05 00:30:34 [INFO] - 清理微信监听
2025-04-05 00:30:34 [INFO] - 开始清理所有监听目标
2025-04-05 00:30:34 [INFO] - 尝试移除监听目标: 文件传输助手
2025-04-05 00:30:39 [ERROR] - 移除监听目标 文件传输助手 失败: list index out of range
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\src\wechat_handler.py", line 74, in remove_listener
    self.wx.ChatWith(target)
    ~~~~~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\wxauto.py", line 327, in ChatWith
    search_result_control = self.SessionBox.GetChildren()[1].GetChildren()[1].GetFirstChildControl()
                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
IndexError: list index out of range
2025-04-05 00:30:39 [INFO] - 尝试移除监听目标: 微信支付
2025-04-05 00:30:45 [ERROR] - 移除监听目标 微信支付 失败: list index out of range
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\src\wechat_handler.py", line 74, in remove_listener
    self.wx.ChatWith(target)
    ~~~~~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\wxauto.py", line 327, in ChatWith
    search_result_control = self.SessionBox.GetChildren()[1].GetChildren()[1].GetFirstChildControl()
                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
IndexError: list index out of range
2025-04-05 00:30:45 [INFO] - 所有监听目标已清理完成
2025-04-05 00:30:45 [INFO] - 微信监听已清理
2025-04-05 00:30:45 [INFO] - 监控已完全停止
2025-04-05 00:30:54 [INFO] - 开始启动监控
2025-04-05 00:30:54 [INFO] - 初始化微信处理器
2025-04-05 00:30:54 [INFO] - 微信处理器初始化完成
2025-04-05 00:30:54 [INFO] - 初始化AI处理器
2025-04-05 00:30:54 [INFO] - 开始配置AI服务...
2025-04-05 00:30:54 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-05 00:30:54 [INFO] - AI服务配置完成
2025-04-05 00:30:54 [INFO] - 连接微信客户端
2025-04-05 00:30:54 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-05 00:30:54 [INFO] - 已连接微信账号: 上下左右
2025-04-05 00:30:54 [INFO] - 创建消息监控器
2025-04-05 00:30:54 [INFO] - 消息监控器初始化完成
2025-04-05 00:30:56 [INFO] - 创建监听设置线程
2025-04-05 00:30:56 [INFO] - 设置微信监听
2025-04-05 00:30:56 [INFO] - 线程开始设置微信监听
2025-04-05 00:30:56 [INFO] - 开始设置 2 个监听目标
2025-04-05 00:30:56 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-05 00:30:57 [INFO] - 成功添加监听目标: 文件传输助手
2025-04-05 00:30:57 [INFO] - 尝试添加监听目标: 微信支付
2025-04-05 00:30:57 [INFO] - 成功添加监听目标: 微信支付
2025-04-05 00:30:57 [INFO] - 监听设置完成，成功添加 2 个目标
2025-04-05 00:30:57 [INFO] - 线程成功设置监听: ['文件传输助手', '微信支付']
2025-04-05 00:30:57 [INFO] - 成功监听目标: 文件传输助手, 微信支付
2025-04-05 00:30:57 [INFO] - 更新监听目标: 文件传输助手, 微信支付
2025-04-05 00:30:57 [INFO] - 启动消息监控线程
2025-04-05 00:30:57 [INFO] - 监控已成功启动
2025-04-05 00:30:57 [INFO] - 消息监控线程启动
2025-04-05 00:31:18 [ERROR] - 获取 文件传输助手 的消息时出错: (-2147220991, '事件无法调用任何订户', (None, None, None, 0, None))
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\src\wechat_handler.py", line 42, in get_new_messages
    new_messages = self.wx.GetListenMessage(target)
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\wxauto.py", line 591, in GetListenMessage
    msg = chat.GetNewMessage(savepic=chat.savepic, savefile=chat.savefile, savevoice=chat.savevoice)
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\elements.py", line 338, in GetNewMessage
    self.usedmsgid = [i[-1] for i in self._getmsgs(MsgItems)]
                                     ~~~~~~~~~~~~~^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\elements.py", line 68, in _getmsgs
    if MsgItem.ControlTypeName == 'ListItemControl':
       ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\uiautomation.py", line 5796, in ControlTypeName
    return ControlTypeNames[self.ControlType]
                            ^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\uiautomation.py", line 5494, in ControlType
    return self.Element.CurrentControlType
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_ctypes.COMError: (-2147220991, '事件无法调用任何订户', (None, None, None, 0, None))
2025-04-05 00:31:19 [ERROR] - 获取 文件传输助手 的消息时出错: (-2147220991, '事件无法调用任何订户', (None, None, None, 0, None))
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\src\wechat_handler.py", line 42, in get_new_messages
    new_messages = self.wx.GetListenMessage(target)
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\wxauto.py", line 591, in GetListenMessage
    msg = chat.GetNewMessage(savepic=chat.savepic, savefile=chat.savefile, savevoice=chat.savevoice)
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\elements.py", line 333, in GetNewMessage
    MsgItems = self.C_MsgList.GetChildren()
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\uiautomation.py", line 5960, in GetChildren
    child = self.GetFirstChildControl()
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\uiautomation.py", line 5855, in GetFirstChildControl
    ele = _AutomationClient.instance().ViewWalker.GetFirstChildElement(self.Element)
_ctypes.COMError: (-2147220991, '事件无法调用任何订户', (None, None, None, 0, None))
2025-04-05 00:31:20 [ERROR] - 获取 文件传输助手 的消息时出错: (-2147220991, '事件无法调用任何订户', (None, None, None, 0, None))
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\src\wechat_handler.py", line 42, in get_new_messages
    new_messages = self.wx.GetListenMessage(target)
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\wxauto.py", line 591, in GetListenMessage
    msg = chat.GetNewMessage(savepic=chat.savepic, savefile=chat.savefile, savevoice=chat.savevoice)
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\elements.py", line 333, in GetNewMessage
    MsgItems = self.C_MsgList.GetChildren()
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\uiautomation.py", line 5960, in GetChildren
    child = self.GetFirstChildControl()
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\uiautomation.py", line 5855, in GetFirstChildControl
    ele = _AutomationClient.instance().ViewWalker.GetFirstChildElement(self.Element)
_ctypes.COMError: (-2147220991, '事件无法调用任何订户', (None, None, None, 0, None))
