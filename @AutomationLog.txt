2025-04-04 21:21:18 [INFO] - === 微信AI助手启动 ===
2025-04-04 21:21:18 [INFO] - 初始化主应用程序
2025-04-04 21:21:18 [INFO] - 设置UI事件处理器完成
2025-04-04 21:21:18 [INFO] - 显示主窗口
2025-04-04 21:21:19 [INFO] - 进入应用程序主循环
2025-04-04 21:21:22 [INFO] - 开始启动监控
2025-04-04 21:21:22 [INFO] - 初始化微信处理器
2025-04-04 21:21:24 [INFO] - 微信处理器初始化完成
2025-04-04 21:21:24 [INFO] - 初始化AI处理器
2025-04-04 21:21:24 [INFO] - 开始配置AI服务...
2025-04-04 21:21:24 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-04 21:21:24 [INFO] - AI服务配置完成
2025-04-04 21:21:24 [INFO] - 连接微信客户端
2025-04-04 21:21:24 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-04 21:21:24 [INFO] - 已连接微信账号: 上下左右
2025-04-04 21:21:24 [INFO] - 创建消息监控器
2025-04-04 21:21:24 [INFO] - 消息监控器初始化完成
2025-04-04 21:21:24 [INFO] - 设置微信监听
2025-04-04 21:21:24 [INFO] - 开始设置 1 个监听目标
2025-04-04 21:21:24 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-04 21:21:29 [INFO] - 监听设置完成，成功添加 0 个目标
2025-04-04 21:21:29 [INFO] - 未设置特定监听目标，监听所有聊天
2025-04-04 21:21:29 [INFO] - 启动消息监控线程
2025-04-04 21:21:29 [INFO] - 监控已成功启动
2025-04-04 21:21:29 [INFO] - 消息监控线程启动
2025-04-04 21:21:37.037 wxauto.py[574] AddListenChat -> Can not move cursor. ListItemControl's BoundingRectangle is (0,0,0,0)[0x0]. SearchProperties: {RegexName: '文件传输助手', ControlType: ListItemControl}
2025-04-04 21:21:37 [ERROR] - 添加监听目标 文件传输助手 失败: cannot unpack non-iterable NoneType object
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\src\wechat_handler.py", line 114, in _setup_listener
    self.wx.AddListenChat(target, savepic=True, savefile=True, savevoice=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\wxauto.py", line 574, in AddListenChat
    self.SessionBox.ListItemControl(RegexName=who).DoubleClick(simulateMove=False)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\uiautomation.py", line 6193, in DoubleClick
    x, y = self.MoveCursorToInnerPos(x, y, ratioX, ratioY, simulateMove)
    ^^^^
TypeError: cannot unpack non-iterable NoneType object
2025-04-04 21:21:42 [INFO] - 停止监控
2025-04-04 21:21:42 [INFO] - 停止消息监控线程
2025-04-04 21:21:42 [INFO] - 消息监控线程已停止
2025-04-04 21:21:42 [INFO] - 开始清理所有监听目标
2025-04-04 21:21:42 [INFO] - 尝试移除监听目标: 文件传输助手
2025-04-04 21:21:49 [INFO] - 成功移除监听目标: 文件传输助手
2025-04-04 21:21:49 [INFO] - 所有监听目标已清理完成
2025-04-04 21:21:49 [INFO] - 微信监听已清理
2025-04-04 21:21:49 [INFO] - 监控已完全停止
2025-04-04 21:21:53 [INFO] - 开始启动监控
2025-04-04 21:21:53 [INFO] - 初始化微信处理器
2025-04-04 21:21:55 [INFO] - 微信处理器初始化完成
2025-04-04 21:21:55 [INFO] - 初始化AI处理器
2025-04-04 21:21:55 [INFO] - 开始配置AI服务...
2025-04-04 21:21:55 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-04 21:21:55 [INFO] - AI服务配置完成
2025-04-04 21:21:55 [INFO] - 连接微信客户端
2025-04-04 21:21:55 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-04 21:21:55 [INFO] - 已连接微信账号: 上下左右
2025-04-04 21:21:55 [INFO] - 创建消息监控器
2025-04-04 21:21:55 [INFO] - 消息监控器初始化完成
2025-04-04 21:21:55 [INFO] - 设置微信监听
2025-04-04 21:21:55 [INFO] - 开始设置 1 个监听目标
2025-04-04 21:21:55 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-04 21:22:00 [INFO] - 监听设置完成，成功添加 0 个目标
2025-04-04 21:22:00 [INFO] - 未设置特定监听目标，监听所有聊天
2025-04-04 21:22:00 [INFO] - 启动消息监控线程
2025-04-04 21:22:00 [INFO] - 监控已成功启动
2025-04-04 21:22:00 [INFO] - 消息监控线程启动
2025-04-04 21:22:00 [INFO] - 成功添加监听目标: 文件传输助手
2025-04-04 21:22:16 [INFO] - 从 文件传输助手 获取到 2 条新消息
2025-04-04 21:22:16 [INFO] - 收到来自 文件传输助手 的消息: 21:22
2025-04-04 21:22:16 [INFO] - 收到来自 文件传输助手 的消息: 你好你好你好
2025-04-04 21:22:16 [INFO] - 已缓存来自 文件传输助手 的消息: 你好你好你好
2025-04-04 21:22:18 [INFO] - 从 文件传输助手 获取到 1 条新消息
2025-04-04 21:22:18 [INFO] - 收到来自 文件传输助手 的消息: 123
2025-04-04 21:22:18 [INFO] - 已缓存来自 文件传输助手 的消息: 123
2025-04-04 21:22:20 [INFO] - 从 文件传输助手 获取到 1 条新消息
2025-04-04 21:22:20 [INFO] - 收到来自 文件传输助手 的消息: 456
2025-04-04 21:22:20 [INFO] - 已缓存来自 文件传输助手 的消息: 456
2025-04-04 21:22:23 [INFO] - 开始处理来自 文件传输助手 的消息组合
2025-04-04 21:22:23 [INFO] - 开始处理消息: 用户发送了以下多条消息：
用户: 你好你好你好
用户: 123
用户: 456
请统一回复这些消息。
2025-04-04 21:22:23 [INFO] - 使用模型 deepseek-ai/DeepSeek-R1-Distill-Qwen-7B 发送请求
2025-04-04 21:22:25 [INFO] - 收到AI响应: 你好！很高兴为你服务。请问有什么可以帮您的吗？
2025-04-04 21:22:25 [INFO] - 收到AI回复: 你好！很高兴为你服务。请问有什么可以帮您的吗？
2025-04-04 21:22:25 [INFO] - 尝试发送消息到 文件传输助手: 你好！很高兴为你服务。请问有什么可以帮您的吗？
2025-04-04 21:22:27 [INFO] - 成功发送消息到 文件传输助手
2025-04-04 21:22:27 [INFO] - 已成功发送回复到 文件传输助手
2025-04-04 21:22:28 [INFO] - 从 文件传输助手 获取到 1 条新消息
2025-04-04 21:22:28 [INFO] - 收到来自 文件传输助手 的消息: 你好！很高兴为你服务。请问有什么可以帮您的吗？
2025-04-04 21:22:28 [INFO] - 跳过缓存AI回复内容: 你好！很高兴为你服务。请问有什么可以帮您的吗？
2025-04-04 21:24:19 [INFO] - === 微信AI助手退出，退出码: 0 ===
2025-04-04 21:35:27 [INFO] - 全局异常处理器已安装
2025-04-04 21:35:27 [INFO] - === 微信AI助手启动 ===
2025-04-04 21:35:27 [INFO] - 初始化主应用程序
2025-04-04 21:35:27 [CRITICAL] - 程序崩溃: name 'QtCore' is not defined
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\main.py", line 270, in <module>
    app = MainApp()
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\main.py", line 161, in __init__
    QtCore.qInstallMessageHandler(qt_message_handler)
    ^^^^^^
NameError: name 'QtCore' is not defined
2025-04-04 21:41:46 [INFO] - 全局异常处理器已安装
2025-04-04 21:41:46 [INFO] - === 微信AI助手启动 ===
2025-04-04 21:41:46 [INFO] - 初始化主应用程序
2025-04-04 21:41:46 [CRITICAL] - 程序崩溃: name 'QtCore' is not defined
Traceback (most recent call last):
  File "C:\Users\32294\Desktop\微信机器人相关代码\源码\wx\main.py", line 270, in <module>
    app = MainApp()
  File "C:\Users\32294\Desktop\微信机器人相关代码\源码\wx\main.py", line 161, in __init__
    QtCore.qInstallMessageHandler(qt_message_handler)
    ^^^^^^
NameError: name 'QtCore' is not defined
2025-04-04 21:41:51 [INFO] - 全局异常处理器已安装
2025-04-04 21:41:51 [INFO] - === 微信AI助手启动 ===
2025-04-04 21:41:51 [INFO] - 初始化主应用程序
2025-04-04 21:41:51 [CRITICAL] - 程序崩溃: name 'QtCore' is not defined
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\main.py", line 270, in <module>
    app = MainApp()
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\main.py", line 161, in __init__
    QtCore.qInstallMessageHandler(qt_message_handler)
    ^^^^^^
NameError: name 'QtCore' is not defined
2025-04-04 21:42:46 [INFO] - 全局异常处理器已安装
2025-04-04 21:42:46 [INFO] - === 微信AI助手启动 ===
2025-04-04 21:42:46 [INFO] - 初始化主应用程序
2025-04-04 21:42:46 [INFO] - 设置UI事件处理器完成
2025-04-04 21:42:46 [INFO] - 显示主窗口
2025-04-04 21:42:47 [INFO] - 进入应用程序主循环
2025-04-04 21:43:06 [INFO] - 开始启动监控
2025-04-04 21:43:06 [INFO] - 初始化微信处理器
2025-04-04 21:43:08 [INFO] - 微信处理器初始化完成
2025-04-04 21:43:08 [INFO] - 初始化AI处理器
2025-04-04 21:43:08 [INFO] - 开始配置AI服务...
2025-04-04 21:43:08 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-04 21:43:08 [INFO] - AI服务配置完成
2025-04-04 21:43:08 [INFO] - 连接微信客户端
2025-04-04 21:43:08 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-04 21:43:08 [INFO] - 已连接微信账号: 上下左右
2025-04-04 21:43:08 [INFO] - 创建消息监控器
2025-04-04 21:43:08 [INFO] - 消息监控器初始化完成
2025-04-04 21:43:08 [INFO] - 设置微信监听
2025-04-04 21:43:08 [INFO] - 开始设置 1 个监听目标
2025-04-04 21:43:08 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-04 21:43:13 [INFO] - 监听设置完成，成功添加 0 个目标
2025-04-04 21:43:13 [INFO] - 未设置特定监听目标，监听所有聊天
2025-04-04 21:43:13 [INFO] - 启动消息监控线程
2025-04-04 21:43:13 [INFO] - 监控已成功启动
2025-04-04 21:43:13 [INFO] - 消息监控线程启动
2025-04-04 21:43:18 [ERROR] - 添加监听目标 文件传输助手 失败: list index out of range
Traceback (most recent call last):
  File "c:\Users\32294\Desktop\微信机器人相关代码\源码\wx\src\wechat_handler.py", line 114, in _setup_listener
    self.wx.AddListenChat(target, savepic=True, savefile=True, savevoice=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\wxauto.py", line 573, in AddListenChat
    self.ChatWith(who)
    ~~~~~~~~~~~~~^^^^^
  File "C:\Users\32294\AppData\Local\Programs\Python\Python313\Lib\site-packages\wxauto\wxauto.py", line 327, in ChatWith
    search_result_control = self.SessionBox.GetChildren()[1].GetChildren()[1].GetFirstChildControl()
                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
IndexError: list index out of range
2025-04-04 21:43:18 [WARNING] - Qt警告: QObject::connect: Cannot queue arguments of type 'QTextCursor'
(Make sure 'QTextCursor' is registered using qRegisterMetaType().)
2025-04-04 21:43:21 [INFO] - 停止监控
2025-04-04 21:43:21 [INFO] - 停止消息监控线程
2025-04-04 21:43:21 [INFO] - 消息监控线程已停止
2025-04-04 21:43:21 [INFO] - 开始清理所有监听目标
2025-04-04 21:43:21 [INFO] - 尝试移除监听目标: 文件传输助手
2025-04-04 21:43:28 [INFO] - 成功移除监听目标: 文件传输助手
2025-04-04 21:43:28 [INFO] - 所有监听目标已清理完成
2025-04-04 21:43:28 [INFO] - 微信监听已清理
2025-04-04 21:43:28 [INFO] - 监控已完全停止
2025-04-04 21:43:36 [INFO] - 开始启动监控
2025-04-04 21:43:36 [INFO] - 初始化微信处理器
2025-04-04 21:43:38 [INFO] - 微信处理器初始化完成
2025-04-04 21:43:38 [INFO] - 初始化AI处理器
2025-04-04 21:43:38 [INFO] - 开始配置AI服务...
2025-04-04 21:43:38 [INFO] - 使用自定义服务地址: https://api.siliconflow.cn/v1
2025-04-04 21:43:38 [INFO] - AI服务配置完成
2025-04-04 21:43:38 [INFO] - 连接微信客户端
2025-04-04 21:43:38 [INFO] - 微信初始化成功，当前账号: 上下左右
2025-04-04 21:43:38 [INFO] - 已连接微信账号: 上下左右
2025-04-04 21:43:38 [INFO] - 创建消息监控器
2025-04-04 21:43:38 [INFO] - 消息监控器初始化完成
2025-04-04 21:43:38 [INFO] - 设置微信监听
2025-04-04 21:43:38 [INFO] - 开始设置 1 个监听目标
2025-04-04 21:43:38 [INFO] - 尝试添加监听目标: 文件传输助手
2025-04-04 21:43:43 [INFO] - 监听设置完成，成功添加 0 个目标
2025-04-04 21:43:43 [INFO] - 未设置特定监听目标，监听所有聊天
2025-04-04 21:43:43 [INFO] - 启动消息监控线程
2025-04-04 21:43:43 [INFO] - 监控已成功启动
2025-04-04 21:43:43 [INFO] - 消息监控线程启动
2025-04-04 21:43:43 [INFO] - 成功添加监听目标: 文件传输助手
2025-04-04 21:43:51 [INFO] - 从 文件传输助手 获取到 2 条新消息
2025-04-04 21:43:51 [INFO] - 收到来自 文件传输助手 的消息: 21:43
2025-04-04 21:43:51 [INFO] - 收到来自 文件传输助手 的消息: 123456
2025-04-04 21:43:51 [INFO] - 已缓存来自 文件传输助手 的消息: 123456
2025-04-04 21:43:54 [INFO] - 从 文件传输助手 获取到 1 条新消息
2025-04-04 21:43:54 [INFO] - 收到来自 文件传输助手 的消息: +123456
2025-04-04 21:43:54 [INFO] - 已缓存来自 文件传输助手 的消息: +123456
2025-04-04 21:43:58 [INFO] - 开始处理来自 文件传输助手 的消息组合
2025-04-04 21:43:58 [INFO] - 开始处理消息: 用户发送了以下多条消息：
用户: 123456
用户: +123456
请统一回复这些消息。
2025-04-04 21:43:58 [INFO] - 使用模型 deepseek-ai/DeepSeek-R1-Distill-Qwen-7B 发送请求
2025-04-04 21:44:00 [INFO] - 收到AI响应: 收到123456和+123456。
2025-04-04 21:44:00 [INFO] - 收到AI回复: 收到123456和+123456。
2025-04-04 21:44:00 [INFO] - 尝试发送消息到 文件传输助手: 收到123456和+123456。
2025-04-04 21:44:03 [INFO] - 成功发送消息到 文件传输助手
2025-04-04 21:44:03 [INFO] - 已成功发送回复到 文件传输助手
2025-04-04 21:44:04 [INFO] - 从 文件传输助手 获取到 1 条新消息
2025-04-04 21:44:04 [INFO] - 收到来自 文件传输助手 的消息: 收到123456和+123456。
2025-04-04 21:44:04 [INFO] - 跳过缓存AI回复内容: 收到123456和+123456。
2025-04-04 21:44:35 [INFO] - 停止监控
2025-04-04 21:44:35 [INFO] - 停止消息监控线程
2025-04-04 21:44:35 [INFO] - 消息监控线程已停止
2025-04-04 21:44:35 [INFO] - 开始清理所有监听目标
2025-04-04 21:44:35 [INFO] - 尝试移除监听目标: 文件传输助手
2025-04-04 21:44:43 [INFO] - 成功移除监听目标: 文件传输助手
2025-04-04 21:44:43 [INFO] - 所有监听目标已清理完成
2025-04-04 21:44:43 [INFO] - 微信监听已清理
2025-04-04 21:44:43 [INFO] - 监控已完全停止
2025-04-04 21:44:45 [INFO] - === 微信AI助手退出，退出码: 0 ===
